<!DOCTYPE html>
<html>
<head>
    <title>FastAPI Notes App</title>
</head>
<body style="font-family: Arial; padding: 20px;">
    <h2>FastAPI Notes (Frontend)</h2>

    <h3>Register</h3>
    <input id="reg_username" placeholder="Username"> 
    <input id="reg_password" placeholder="Password" type="password">
    <button onclick="register()">Register</button>
    <p id="reg_msg"></p>

    <h3>Login</h3>
    <input id="login_username" placeholder="Username">
    <input id="login_password" placeholder="Password" type="password">
    <button onclick="login()">Login</button>
    <p id="login_msg"></p>

    <h3>Create Note</h3>
    <input id="note_title" placeholder="Title">
    <input id="note_content" placeholder="Content">
    <button onclick="createNote()">Create Note</button>
    <p id="note_msg"></p>

    <h3>Your Notes</h3>
    <button onclick="getNotes()">Load Notes</button>
    <ul id="notes_list"></ul>

<script>
let token = "";

// Register
async function register() {
    const response = await fetch("http://127.0.0.1:8000/register", {
        method: "POST",
        headers: {"Content-Type": "application/json"},
        body: JSON.stringify({
            username: document.getElementById("reg_username").value,
            password: document.getElementById("reg_password").value
        })
    });

    const data = await response.json();
    document.getElementById("reg_msg").innerText = JSON.stringify(data);
}

// Login
async function login() {
    const formData = new FormData();
    formData.append("username", document.getElementById("login_username").value);
    formData.append("password", document.getElementById("login_password").value);

    const response = await fetch("http://127.0.0.1:8000/token", {
        method: "POST",
        body: formData
    });

    const data = await response.json();
    token = data.access_token;
    document.getElementById("login_msg").innerText = "Logged in! Token saved.";
}

// Create Note
async function createNote() {
    const response = await fetch("http://127.0.0.1:8000/notes/", {
        method: "POST",
        headers: {
            "Content-Type": "application/json",
            "Authorization": "Bearer " + token
        },
        body: JSON.stringify({
            title: document.getElementById("note_title").value,
            content: document.getElementById("note_content").value
        })
    });

    const data = await response.json();
    document.getElementById("note_msg").innerText = JSON.stringify(data);
}

// Get Notes
async function getNotes() {
    const response = await fetch("http://127.0.0.1:8000/notes/", {
        headers: {
            "Authorization": "Bearer " + token
        }
    });

    const notes = await response.json();
    const list = document.getElementById("notes_list");
    list.innerHTML = "";

    notes.forEach(note => {
        const li = document.createElement("li");
        li.innerText = `${note.title} - ${note.content}`;
        list.appendChild(li);
    });
}
</script>
</body>
</html>
